
(function(){
  function drawRadar(ctx, data){
    var w=ctx.canvas.width, h=ctx.canvas.height;
    ctx.clearRect(0,0,w,h);
    var cx=w/2, cy=h/2, R=Math.min(w,h)/2-10;
    var n=data.labels.length, vals=data.datasets[0].data||[];
    ctx.strokeStyle="#0f172a"; ctx.fillStyle="rgba(15,23,42,0.08)";
    var pts=[];
    for (var i=0;i<n;i++){
      var val=(vals[i]||0)/100;
      var ang=-Math.PI/2 + i*2*Math.PI/n;
      pts.push([cx+R*val*Math.cos(ang), cy+R*val*Math.sin(ang)]);
    }
    ctx.beginPath();
    for (var i=0;i<n;i++){ var p=pts[i]; if(i===0) ctx.moveTo(p[0],p[1]); else ctx.lineTo(p[0],p[1]); }
    ctx.closePath(); ctx.fill(); ctx.stroke();
  }
  function drawBar(ctx, data){
    var w=ctx.canvas.width, h=ctx.canvas.height;
    ctx.clearRect(0,0,w,h);
    var ds=data.datasets[0].data||[], n=ds.length, bw=w/(n*1.6);
    for(var i=0;i<n;i++){
      var v=ds[i]||0; var bh=(h-10)*v/100;
      ctx.fillStyle="rgba(15,23,42,0.25)"; ctx.strokeStyle="#0f172a";
      var x= (i+0.3)*w/n; var y=h-bh-5;
      ctx.fillRect(x,y,bw,bh); ctx.strokeRect(x,y,bw,bh);
    }
  }
  window.Chart=function(ctx, cfg){
    var type=cfg.type, data=cfg.data;
    if(type==="radar") drawRadar(ctx, data);
    else if(type==="bar") drawBar(ctx, data);
    this.update=function(){ if(type==="radar") drawRadar(ctx, data); else drawBar(ctx, data); };
  };
})();
